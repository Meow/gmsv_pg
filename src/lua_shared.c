#include "lua_shared.h"

#define LUA_SHARED_DEFINITION(name) name##_t name = NULL

LUA_SHARED_DEFINITION(lua_atpanic);
LUA_SHARED_DEFINITION(lua_checkstack);
LUA_SHARED_DEFINITION(lua_call);
LUA_SHARED_DEFINITION(lua_close);
LUA_SHARED_DEFINITION(lua_concat);
LUA_SHARED_DEFINITION(lua_cpcall);
LUA_SHARED_DEFINITION(lua_createtable);
LUA_SHARED_DEFINITION(lua_dump);
LUA_SHARED_DEFINITION(lua_equal);
LUA_SHARED_DEFINITION(lua_error);
LUA_SHARED_DEFINITION(lua_gc);
LUA_SHARED_DEFINITION(lua_getallocf);
LUA_SHARED_DEFINITION(lua_getfenv);
LUA_SHARED_DEFINITION(lua_getfield);
LUA_SHARED_DEFINITION(lua_gethook);
LUA_SHARED_DEFINITION(lua_gethookcount);
LUA_SHARED_DEFINITION(lua_gethookmask);
LUA_SHARED_DEFINITION(lua_getinfo);
LUA_SHARED_DEFINITION(lua_getlocal);
LUA_SHARED_DEFINITION(lua_getmetatable);
LUA_SHARED_DEFINITION(lua_getstack);
LUA_SHARED_DEFINITION(lua_gettable);
LUA_SHARED_DEFINITION(lua_gettop);
LUA_SHARED_DEFINITION(lua_getupvalue);
LUA_SHARED_DEFINITION(lua_insert);
LUA_SHARED_DEFINITION(lua_iscfunction);
LUA_SHARED_DEFINITION(lua_isnumber);
LUA_SHARED_DEFINITION(lua_isstring);
LUA_SHARED_DEFINITION(lua_isuserdata);
LUA_SHARED_DEFINITION(lua_lessthan);
LUA_SHARED_DEFINITION(lua_load);
LUA_SHARED_DEFINITION(lua_loadx);
LUA_SHARED_DEFINITION(lua_newstate);
LUA_SHARED_DEFINITION(lua_newthread);
LUA_SHARED_DEFINITION(lua_newuserdata);
LUA_SHARED_DEFINITION(lua_next);
LUA_SHARED_DEFINITION(lua_objlen);
LUA_SHARED_DEFINITION(lua_pcall);
LUA_SHARED_DEFINITION(lua_pushboolean);
LUA_SHARED_DEFINITION(lua_pushcclosure);
LUA_SHARED_DEFINITION(lua_pushfstring);
LUA_SHARED_DEFINITION(lua_pushlightuserdata);
LUA_SHARED_DEFINITION(lua_pushlstring);
LUA_SHARED_DEFINITION(lua_pushnil);
LUA_SHARED_DEFINITION(lua_pushnumber);
LUA_SHARED_DEFINITION(lua_pushstring);
LUA_SHARED_DEFINITION(lua_pushthread);
LUA_SHARED_DEFINITION(lua_pushvalue);
LUA_SHARED_DEFINITION(lua_pushvfstring);
LUA_SHARED_DEFINITION(lua_rawequal);
LUA_SHARED_DEFINITION(lua_rawget);
LUA_SHARED_DEFINITION(lua_rawgeti);
LUA_SHARED_DEFINITION(lua_rawset);
LUA_SHARED_DEFINITION(lua_rawseti);
LUA_SHARED_DEFINITION(lua_remove);
LUA_SHARED_DEFINITION(lua_replace);
LUA_SHARED_DEFINITION(lua_setallocf);
LUA_SHARED_DEFINITION(lua_setfenv);
LUA_SHARED_DEFINITION(lua_setfield);
LUA_SHARED_DEFINITION(lua_sethook);
LUA_SHARED_DEFINITION(lua_setlocal);
LUA_SHARED_DEFINITION(lua_setmetatable);
LUA_SHARED_DEFINITION(lua_settable);
LUA_SHARED_DEFINITION(lua_settop);
LUA_SHARED_DEFINITION(lua_setupvalue);
LUA_SHARED_DEFINITION(lua_status);
LUA_SHARED_DEFINITION(lua_toboolean);
LUA_SHARED_DEFINITION(lua_tocfunction);
LUA_SHARED_DEFINITION(lua_tolstring);
LUA_SHARED_DEFINITION(lua_tonumber);
LUA_SHARED_DEFINITION(lua_topointer);
LUA_SHARED_DEFINITION(lua_tothread);
LUA_SHARED_DEFINITION(lua_touserdata);
LUA_SHARED_DEFINITION(lua_type);
LUA_SHARED_DEFINITION(lua_typename);
LUA_SHARED_DEFINITION(lua_upvalueid);
LUA_SHARED_DEFINITION(lua_upvaluejoin);
LUA_SHARED_DEFINITION(lua_xmove);
LUA_SHARED_DEFINITION(lua_yield);
LUA_SHARED_DEFINITION(luaJIT_setmode);
LUA_SHARED_DEFINITION(luaL_addlstring);
LUA_SHARED_DEFINITION(luaL_addstring);
LUA_SHARED_DEFINITION(luaL_addvalue);
LUA_SHARED_DEFINITION(luaL_argerror);
LUA_SHARED_DEFINITION(luaL_buffinit);
LUA_SHARED_DEFINITION(luaL_callmeta);
LUA_SHARED_DEFINITION(luaL_checkany);
LUA_SHARED_DEFINITION(luaL_checklstring);
LUA_SHARED_DEFINITION(luaL_checknumber);
LUA_SHARED_DEFINITION(luaL_checkoption);
LUA_SHARED_DEFINITION(luaL_checkstack);
LUA_SHARED_DEFINITION(luaL_checktype);
LUA_SHARED_DEFINITION(luaL_checkudata);
LUA_SHARED_DEFINITION(luaL_error);
LUA_SHARED_DEFINITION(luaL_execresult);
LUA_SHARED_DEFINITION(luaL_fileresult);
LUA_SHARED_DEFINITION(luaL_findtable);
LUA_SHARED_DEFINITION(luaL_getmetafield);
LUA_SHARED_DEFINITION(luaL_gsub);
LUA_SHARED_DEFINITION(luaL_loadbuffer);
LUA_SHARED_DEFINITION(luaL_loadbufferx);
LUA_SHARED_DEFINITION(luaL_loadfile);
LUA_SHARED_DEFINITION(luaL_loadfilex);
LUA_SHARED_DEFINITION(luaL_loadstring);
LUA_SHARED_DEFINITION(luaL_newmetatable);
LUA_SHARED_DEFINITION(luaL_newstate);
LUA_SHARED_DEFINITION(luaL_openlib);
LUA_SHARED_DEFINITION(luaL_openlibs);
LUA_SHARED_DEFINITION(luaL_optlstring);
LUA_SHARED_DEFINITION(luaL_optnumber);
LUA_SHARED_DEFINITION(luaL_prepbuffer);
LUA_SHARED_DEFINITION(luaL_pushresult);
LUA_SHARED_DEFINITION(luaL_ref);
LUA_SHARED_DEFINITION(luaL_register);
LUA_SHARED_DEFINITION(luaL_traceback);
LUA_SHARED_DEFINITION(luaL_typerror);
LUA_SHARED_DEFINITION(luaL_unref);
LUA_SHARED_DEFINITION(luaL_where);
LUA_SHARED_DEFINITION(luaopen_base);
LUA_SHARED_DEFINITION(luaopen_bit);
LUA_SHARED_DEFINITION(luaopen_debug);
LUA_SHARED_DEFINITION(luaopen_jit);
LUA_SHARED_DEFINITION(luaopen_math);
LUA_SHARED_DEFINITION(luaopen_os);
LUA_SHARED_DEFINITION(luaopen_package);
LUA_SHARED_DEFINITION(luaopen_string);
LUA_SHARED_DEFINITION(luaopen_table);

void load_lua_shared() {
  module_handle lua_shared;

#ifdef _WIN32
  lua_shared = LoadLibraryA("lua_shared.dll");
#else
  lua_shared = dlopen("garrysmod/bin/lua_shared_srv.so", RTLD_LAZY);
#endif

  GET_MOD_FUNC(lua_atpanic);
  GET_MOD_FUNC(lua_checkstack);
  GET_MOD_FUNC(lua_call);
  GET_MOD_FUNC(lua_close);
  GET_MOD_FUNC(lua_concat);
  GET_MOD_FUNC(lua_cpcall);
  GET_MOD_FUNC(lua_createtable);
  GET_MOD_FUNC(lua_dump);
  GET_MOD_FUNC(lua_equal);
  GET_MOD_FUNC(lua_error);
  GET_MOD_FUNC(lua_gc);
  GET_MOD_FUNC(lua_getallocf);
  GET_MOD_FUNC(lua_getfenv);
  GET_MOD_FUNC(lua_getfield);
  GET_MOD_FUNC(lua_gethook);
  GET_MOD_FUNC(lua_gethookcount);
  GET_MOD_FUNC(lua_gethookmask);
  GET_MOD_FUNC(lua_getinfo);
  GET_MOD_FUNC(lua_getlocal);
  GET_MOD_FUNC(lua_getmetatable);
  GET_MOD_FUNC(lua_getstack);
  GET_MOD_FUNC(lua_gettable);
  GET_MOD_FUNC(lua_gettop);
  GET_MOD_FUNC(lua_getupvalue);
  GET_MOD_FUNC(lua_insert);
  GET_MOD_FUNC(lua_iscfunction);
  GET_MOD_FUNC(lua_isnumber);
  GET_MOD_FUNC(lua_isstring);
  GET_MOD_FUNC(lua_isuserdata);
  GET_MOD_FUNC(lua_lessthan);
  GET_MOD_FUNC(lua_load);
  GET_MOD_FUNC(lua_loadx);
  GET_MOD_FUNC(lua_newstate);
  GET_MOD_FUNC(lua_newthread);
  GET_MOD_FUNC(lua_newuserdata);
  GET_MOD_FUNC(lua_next);
  GET_MOD_FUNC(lua_objlen);
  GET_MOD_FUNC(lua_pcall);
  GET_MOD_FUNC(lua_pushboolean);
  GET_MOD_FUNC(lua_pushcclosure);
  GET_MOD_FUNC(lua_pushfstring);
  GET_MOD_FUNC(lua_pushlightuserdata);
  GET_MOD_FUNC(lua_pushlstring);
  GET_MOD_FUNC(lua_pushnil);
  GET_MOD_FUNC(lua_pushnumber);
  GET_MOD_FUNC(lua_pushstring);
  GET_MOD_FUNC(lua_pushthread);
  GET_MOD_FUNC(lua_pushvalue);
  GET_MOD_FUNC(lua_pushvfstring);
  GET_MOD_FUNC(lua_rawequal);
  GET_MOD_FUNC(lua_rawget);
  GET_MOD_FUNC(lua_rawgeti);
  GET_MOD_FUNC(lua_rawset);
  GET_MOD_FUNC(lua_rawseti);
  GET_MOD_FUNC(lua_remove);
  GET_MOD_FUNC(lua_replace);
  GET_MOD_FUNC(lua_setallocf);
  GET_MOD_FUNC(lua_setfenv);
  GET_MOD_FUNC(lua_setfield);
  GET_MOD_FUNC(lua_sethook);
  GET_MOD_FUNC(lua_setlocal);
  GET_MOD_FUNC(lua_setmetatable);
  GET_MOD_FUNC(lua_settable);
  GET_MOD_FUNC(lua_settop);
  GET_MOD_FUNC(lua_setupvalue);
  GET_MOD_FUNC(lua_status);
  GET_MOD_FUNC(lua_toboolean);
  GET_MOD_FUNC(lua_tocfunction);
  GET_MOD_FUNC(lua_tolstring);
  GET_MOD_FUNC(lua_tonumber);
  GET_MOD_FUNC(lua_topointer);
  GET_MOD_FUNC(lua_tothread);
  GET_MOD_FUNC(lua_touserdata);
  GET_MOD_FUNC(lua_type);
  GET_MOD_FUNC(lua_typename);
  GET_MOD_FUNC(lua_upvalueid);
  GET_MOD_FUNC(lua_upvaluejoin);
  GET_MOD_FUNC(lua_xmove);
  GET_MOD_FUNC(lua_yield);
  GET_MOD_FUNC(luaJIT_setmode);
  GET_MOD_FUNC(luaL_addlstring);
  GET_MOD_FUNC(luaL_addstring);
  GET_MOD_FUNC(luaL_addvalue);
  GET_MOD_FUNC(luaL_argerror);
  GET_MOD_FUNC(luaL_buffinit);
  GET_MOD_FUNC(luaL_callmeta);
  GET_MOD_FUNC(luaL_checkany);
  GET_MOD_FUNC(luaL_checklstring);
  GET_MOD_FUNC(luaL_checknumber);
  GET_MOD_FUNC(luaL_checkoption);
  GET_MOD_FUNC(luaL_checkstack);
  GET_MOD_FUNC(luaL_checktype);
  GET_MOD_FUNC(luaL_checkudata);
  GET_MOD_FUNC(luaL_error);
  GET_MOD_FUNC(luaL_execresult);
  GET_MOD_FUNC(luaL_fileresult);
  GET_MOD_FUNC(luaL_findtable);
  GET_MOD_FUNC(luaL_getmetafield);
  GET_MOD_FUNC(luaL_gsub);
  GET_MOD_FUNC(luaL_loadbuffer);
  GET_MOD_FUNC(luaL_loadbufferx);
  GET_MOD_FUNC(luaL_loadfile);
  GET_MOD_FUNC(luaL_loadfilex);
  GET_MOD_FUNC(luaL_loadstring);
  GET_MOD_FUNC(luaL_newmetatable);
  GET_MOD_FUNC(luaL_newstate);
  GET_MOD_FUNC(luaL_openlib);
  GET_MOD_FUNC(luaL_openlibs);
  GET_MOD_FUNC(luaL_optlstring);
  GET_MOD_FUNC(luaL_optnumber);
  GET_MOD_FUNC(luaL_prepbuffer);
  GET_MOD_FUNC(luaL_pushresult);
  GET_MOD_FUNC(luaL_ref);
  GET_MOD_FUNC(luaL_register);
  GET_MOD_FUNC(luaL_traceback);
  GET_MOD_FUNC(luaL_typerror);
  GET_MOD_FUNC(luaL_unref);
  GET_MOD_FUNC(luaL_where);
  GET_MOD_FUNC(luaopen_base);
  GET_MOD_FUNC(luaopen_bit);
  GET_MOD_FUNC(luaopen_debug);
  GET_MOD_FUNC(luaopen_jit);
  GET_MOD_FUNC(luaopen_math);
  GET_MOD_FUNC(luaopen_os);
  GET_MOD_FUNC(luaopen_package);
  GET_MOD_FUNC(luaopen_string);
  GET_MOD_FUNC(luaopen_table);
}
